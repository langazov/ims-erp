# Production values for ERP System

global:
  imageRegistry: ghcr.io
  imagePullSecrets:
    - name: registry-secret

# Application Configuration
config:
  appName: "erp-system"
  environment: "production"
  logLevel: "info"
  logFormat: "json"

# Client Command Service
clientCommandService:
  enabled: true
  replicaCount: 5
  image:
    repository: ghcr.io/ims-erp/system-client-command-service
    tag: latest
    pullPolicy: Always
  service:
    type: ClusterIP
    port: 8080
  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  autoscaling:
    enabled: true
    minReplicas: 5
    maxReplicas: 50
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  config:
    mongodb:
      host: "mongodb-erp-system"
      port: 27017
      database: "erp_system"
    redis:
      host: "redis-erp-system"
      port: 6379
    nats:
      host: "nats-erp-system"
      port: 4222

# Auth Service
authService:
  enabled: true
  replicaCount: 5
  image:
    repository: ghcr.io/ims-erp/system-auth-service
    tag: latest
    pullPolicy: Always
  service:
    type: ClusterIP
    port: 8080
  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  autoscaling:
    enabled: true
    minReplicas: 5
    maxReplicas: 30
    targetCPUUtilizationPercentage: 70

# Ingress Configuration
ingress:
  enabled: true
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "60"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "60"
    nginx.ingress.kubernetes.io/configuration-snippet: |
      more_set_headers "X-Frame-Options: DENY";
      more_set_headers "X-Content-Type-Options: nosniff";
      more_set_headers "X-XSS-Protection: 1; mode=block";
      more_set_headers "Strict-Transport-Security: max-age=31536000; includeSubDomains";
  hosts:
    - host: erp.example.com
      paths:
        - path: /api
          pathType: Prefix
  tls:
    - secretName: erp-tls
      hosts:
        - erp.example.com

# MongoDB (dedicated instance)
mongodb:
  enabled: true
  architecture: replicaset
  replicaCount: 3
  auth:
    enabled: true
    existingSecret: mongodb-credentials
  metrics:
    enabled: true

# Redis (cluster mode)
redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: true
    existingSecret: redis-credentials
  master:
    resources:
      requests:
        memory: "512Mi"
        cpu: "250m"
      limits:
        memory: "1Gi"
        cpu: "500m"

# NATS (dedicated cluster)
nats:
  enabled: true
  natsbox:
    enabled: false
  exporter:
    enabled: true

# MinIO (distributed)
minio:
  enabled: true
  mode: distributed
  replicas: 8
  resources:
    requests:
      cpu: "250m"
      memory: "512Mi"
  persistence:
    size: 100Gi

# Elasticsearch (dedicated cluster)
elasticsearch:
  enabled: true
  global:
    kibanaEnabled: true
  master:
    replicaCount: 3
    resources:
      requests:
        cpu: "250m"
        memory: "512Mi"
  data:
    replicaCount: 5
    resources:
      requests:
        cpu: "500m"
        memory: "2Gi"
  resources:
    requests:
      cpu: "250m"
      memory: "512Mi"

# Monitoring
monitoring:
  enabled: true
  prometheus:
    enabled: true
  grafana:
    enabled: true

# Security
security:
  rbac:
    create: true
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 1000
    fsGroup: 1000
  containerSecurityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    capabilities:
      drop:
        - ALL

# Network Policies
networkPolicies:
  enabled: true

# Pod Disruption Budgets
podDisruptionBudgets:
  enabled: true
  minAvailable: 2

# High Availability
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app
                operator: In
                values:
                  - client-command-service
          topologyKey: kubernetes.io/hostname

# Rolling Update Strategy
rollingUpdate:
  maxSurge: 1
  maxUnavailable: 0
